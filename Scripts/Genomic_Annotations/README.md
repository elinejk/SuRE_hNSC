# Annotation with genomic regions
The scripts that were used to overlap emVars, control SNPs and all SuRE SNPs with promoters, enhancers, DHS, and gencode annotations; and to generate plots showing the overlaps.

## 1. Annotation of emVars
*genomic features* \
**annotations.job:** bash script where you can specify your input file and output file, and run the following script:
- **add_all_genomic_features_28022024.R:** adds to your input file: 'general' promoters and enhancers from UCSC and Hoffman et al. (_not used in the manuscript_), cell type 'specific' promoters and enhancers from chromHMM predictions, gencode locations (exon, intron, intergenic), closest TSS, and cell type 'specific' DHS.

*putative targets* \
**overlap_with_HiC.R:** this script was used to annotate hNSC emVars with HiC data for excitatory neurons generated by Song et al. 2019 (PMID: 31367015), and results of massively parallel disruption of enhancers active in human neural stem cells generated by Geller et al. 2024 (PMID: 38271204). We used both sets to assign putative targets to hNSC emVars.

## 2. Generate plots
It is important that you have already calculated the p-values for each comparison using the Fisher exact test (in the 'statistics' directory). For the Fisher exact test, create a file that contains the total number of emVars, control SNPs and all SuRE SNPs, and the number of SNPs within each annotation category for each. The script will then compare emVars to control SNPs, and emVars to all SuRE SNPs, and outputs the FE, OR, and p-values.
### 2.1 Overlap percentage plots
*genomic features* \
**genomic_location_plots.R:** creates a bargraph with significance indications for the _percentage_ overlap with genomic features. Due to the way the plots are generated, you will have to modify the output of the Fisher exact script. You need two files:
- One file containing all the percentages. It should contain the following columns: Annotation, SNPs (number of SNPs), Percentage, Group (emVar, control or all SuRE)
- One file with the statistics. It should contain the following columns: Annotation, group1 (emVar), group2 (control or all SuRE), p, p.signif (asterisks to indicate the significance in the plot), .y., and y.position. The y.position can take some tweaking. Make sure the group names and Annotations match between the files.

### 2.2 Fold enrichment plots
*genomic features* \
**genomic_location_fe-or_plots.R:** creates a bargraph with significant indications for the _fold enrichment_ (Figures 1E, S1C, and S1D). For this script the Fisher exact output file was also slightly modified. The minimal columns required: Fisher p-value, Annotation category, Fold enrichment, Odds ratio, Comparison (e.g. hNSC emVars vs all SuRE SNPs). This information was taken from the following columns in the Fisher exact output file: Annotation, FE_emvarvscontrol, Fisher_OR_emvarvscontrol, Fisher_p_emVarvscontrol, FE_emvarvsall, Fisher_OR_emvarvsall, Fisher_p_emvarvsall.
